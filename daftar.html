// 1. Inisialisasi Supabase (Menggunakan destrukturisasi agar lebih aman)
const SUPABASE_URL = 'https://biduabmeloughbnqlwcq.supabase.co';
const SUPABASE_KEY = 'sb_publishable_rNKePi7N3qW5GThgZAPmCw_PtjSH5kb'; 

// Pastikan library sudah ter-load sebelum membuat client
const { createClient } = supabase;
const supabaseClient = createClient(SUPABASE_URL, SUPABASE_KEY);

const loginForm = document.getElementById('loginForm');
const btnLogin = document.getElementById('btnLogin');

loginForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    // UI Feedback
    btnLogin.innerText = "Mengecek...";
    btnLogin.disabled = true;

    // Ambil data input
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;

    try {
        // 2. Proses Login ke Supabase Auth
        const { data, error } = await supabaseClient.auth.signInWithPassword({
            email: email,
            password: password,
        });

        if (error) throw error;

        if (data.user) {
            alert("Login Berhasil! Selamat datang.");
            // 3. Arahkan ke dashboard
            window.location.href = 'dashboard.html'; 
        }

    } catch (error) {
        // Memberikan pesan error yang lebih jelas
        alert("Gagal Masuk: " + error.message);
        console.error("Login Error:", error.message);
    } finally {
        btnLogin.innerText = "Masuk";
        btnLogin.disabled = false;
    }
});
